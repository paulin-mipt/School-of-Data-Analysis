
В конторе почта ходит одновременно через Exchange, стоящий за бугром, и через Google Apps. Возникла необходимость написать скрипт для автонастройки Outlook, дабы сильно упростить работу (юзеров больше 600).Немного погуглив, понял, что лучше и легче всего будет использовать AutoIt. До этого скрипты не писал, поэтому сначала пришлось покурить мануалы, почитать FAQ, посмотреть примеры. Наконец дошло дело до самого написания. Вроде бы всё просто: отловил пару случаев, когда возникали дополнительные окна, сделал создание нового профиля, дабы существующие не портить, и закидывание шаблона подписи. Не давалась мне никак только проверка на существование самого Аутлука. По окну и тексту внутри окна он ловиться не хотел, по процессу — ловился всегда, вне зависимости от того, существовал он или нет.Спустя часов пять поиска багов в 200 строках кода я наконец обратил внимание на заголовок окна. Он радостно сообщал: «Меня зовут outlook.exe».


