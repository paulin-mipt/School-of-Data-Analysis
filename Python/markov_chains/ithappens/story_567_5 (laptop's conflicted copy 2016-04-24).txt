
Здравствуйте, с вами снова сисадмин гостиницы. Расскажу-ка я вам на этот раз о сборке серверов.Что обычно представляется более-менее сведущему в области человеку, когда он слышит слово «сервер»? Жуткий вой, тяжеленный корпус из танковой стали, громадная плата, несколько процессоров, уйма планок памяти (обязательно Registered ECC), резервный БП и RAID 1 на «сказях». Как правило, в собранном сервере многопроцессорная мать обслуживает лишь один проц, планок памяти стоит две (редко — четыре), второго БП просто нет, а сказёвые тарахтелки только и занимаются сикингом.Такое чудо досталось и мне. Два видимых процессора на поверку оказались одним гипертрединговым. Единственный гигабайт памяти использовался на всю мощность вместе с четырьмя гигами свопа. Судя по отклику дисковой подсистемы, вся эта прелесть грозила навернуться в ближайшее время. Анализ местного рынка выявил засилье серверов на уже устаревших Core2-образных Xeon, интеловских чипсетах проблемных серий (как раз тех, которые обожают драться за гибридные разъёмы с интегрированным на плату Adaptec: 6 физических разъемов на 12 логических) и недовинчестерах производства Seagate. В ходе тяжких дум о выборе между «очень плохо», «откровенно отвратительно» и «на эти деньги, если мне их дадут, я на Гавайях год отдыхать смогу» я вспомнил бритву Оккама.Что такое сервер? Компьютер, выполняющий служебную роль и работающий без участия человека. Едва ли не основным требованием к серверу является отказоустойчивость. Как она обеспечивается? Надёжность данных обеспечивается кодами коррекции (ECC), дублированием узлов и двойным-тройным запасом по мощности в любом возможном смысле. Registered-память нужна для установки более двух-трёх модулей на канал, RAID в серверах начального уровня всё равно фейковый, а из системных шин поддержкой обнаружения многократных ошибок обладает разве что HyperTransport.В результате был приобретён корпус Chieftec с одноимённым БП на 550 Вт, шестиядерный Phenom II (ECC умеет), четыре терабайтных чёрных «ведра», восемь гробов ECC-памяти, топовая материнка Gigabyte на 870 чипсете и ещё немного по мелочи. Все это дело было собрано и в тостовом (это не опечатка, а намёк на нагрузку) режиме три недели гоняло туда-сюда нолики и единички. Затем конструктор я разобрал, радиаторы безжалостно оторвал от материнской платы, дихлорэтаном отдраил непонятного вида сухач и нанёс КПТ-8. Собрал RAID 5 + hot spare на чипсете, настроил MediaPatrol.Прошёл месяц. Всё работает без нареканий, температурный режим выдерживается, по мощности вся конструкция при пиковой нагрузке едва вываливается за две сотни ватт. Все довольны и счастливы, и счастье это обошлось почти вдвое дешевле, чем какой-нибудь требующий немедленной доводки до ума готовый «пролиант» аналогичной конфигурации и надёжности. Запчасти же можно будет ещё года три приобрести в любом магазине и восстановить работу в течение часа.Знания — сила. Но их ещё применять уметь надо, а не скатываться в шаблонность.


