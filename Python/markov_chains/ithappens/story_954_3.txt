
Работаю на госпредприятии. На территории несколько корпусов, в каждом из которых есть свой сисадмин.Однажды админ соседнего корпуса ушёл в отпуск. Звонят мне из этого корпуса и заявляют: «У нас сканер не сканирует». Думаю, раз коллеги нет, надо помочь. Накинул куртку и пошёл.На этаже в коридоре стоял HP 3390, подключённый к хабу. Весь персонал отправлял на беднягу задания на печать и удалённое сканирование. Сканирование происходило следующим образом: подходил юзер, нажимал кнопку «Сканировать в…», выбирал режим сканирования, нажимал «Сканировать», и файл падал в расшаренную папку на принт-сервере. Сейчас же при нажатии кнопки «Сканировать» ничего не происходило.Надо искать принт-сервер. Ловлю первого попавшегося юзера и спрашиваю: «Где у вас главный компьютер?» Меня ведут к комнате с закрытой дверью: «Вот тут». Четверть часа ушла на поиски ключей от заветной комнаты. Внутри стояли два ПК: совсем дохленький Celeron с 512 МБ ОЗУ на борту, который и был принт-сервером, и сервер-файлообменник с шестью винтами по терабайту.Сел за принт-сервер. В диспетчере задач туева хуча лишних процессов, которые выжрали всю ОЗУ, файл подкачки раздулся до 3,3 ГБ, процессор загружен на 90%. Ну, не справляется с удалённым сканированием бедняга. Очищаю автозагрузку, убиваю процессы — все жизненные показатели в норме. Запускаю удалённое сканирование — тишина. Лезу в трей, в автозагрузку — обнаруживаю тулзу от HP. В автозагрузке она лежит, а вот в диспетчере задач процесса нет. Запускаю тулзу — сканер в коридоре весело жужжит. Закрываю «серверную», отдаю ключи кому надо и ухожу.Через час звонок: «У нас сканер снова не сканирует! Работа стоит!» Снова иду в корпус, ищу ключи. В диспетчере всё тихо, вот только процесса тулзы не видать. «Здесь был кто-нибудь?» Нет, говорят, не было. Ну, мало ли… Закрываю и ухожу.Через два часа история повторяется. В душе слегка матеря и старый комп, и кривой софт HP (процесс отваливается сам безо всяких дампов и объяснений через пару часов), открываю планировщик, даю задачу выполнять hpscantoolbox.exe каждый час. Проверяю — тулза в памяти перезаписывает экзешник, а не создаёт новый процесс. То, что нужно!Прошло два месяца. Всё до сих пор исправно работает. Местный «сисадмин» раньше, оказывается, каждый час перезапускал тулзу вручную через VNC. Был благодарен за оказанную помощь и автоматизацию процесса.


