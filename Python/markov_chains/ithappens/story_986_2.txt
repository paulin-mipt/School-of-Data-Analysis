
Группа зданий соединена оптикой по схеме «звезда». На каждом здании по несколько «кисок», сети нарезаны на вланы, всё красиво упорядочено. Связь с каждым зданием по стандартной схеме: «киска» — конвертер — конвертер — неуправляемый коммутатор — маршрутизатор.Внезапно звонок из одного из зданий: «Нет связи». Начинается разбор. Стучусь на «киску» — всё хорошо. Стучусь на другие узлы в здании — есть ответ, но потери неприятные. Решаю посмотреть, что за трафик гонят к нам, запускаю tcpdump и ушибаю челюсть об стол. Во влане, выделенном под проблемный этаж, свободно гуляют пакеты из других вланов других этажей этого здания.Далее можно много писать про перезалив конфигураций, сброс настроек, всяческие перезагрузки, подмену оборудования на резервное, обзвон всех ближайших знакомых, кто хоть немного в теме… В общем, шаманили, как могли, всем отделом.Оказалось, лепрекон засел в том самом коммутаторе между медиаконвертерами и центральным маршрутизатором. Не мог я предположить, что недавно, когда занимались сетью в главном здании, один из кабелей второпях обжали не то что не по стандарту, а вообще Ктулху его знает как. И что простой с виду гигабитный свитч, получив такой кабель в порт, не отторгнул его, а неведомым образом понял, чего от него хотят, и организовал линк, перемешивая при этом все пакеты в том порядке, какой считал нужным, до ближайшей потери питания.В сухом остатке — несколько часов мозгового штурма, израсходованные полбанки кофе, интересный опыт и забавная история в копилку.


